pkgname=icinga-web
pkgver=1.7.2
pkgrel=1
pkgdesc="Icinga New Web Interface. INSTALLATION at https://github.com/GutenYe/aur/tree/master/icinga-web"
license=('GPL')
arch=('i686' 'x86_64')
depends=('icinga' 'php-pear' 'php-xsl' 'php-ldap')
url="http://www.icinga.org"
source=("http://downloads.sourceforge.net/project/icinga/icinga-web/$pkgver/icinga-web-${pkgver}.tar.gz")

build() {
  cd "$srcdir/$pkgname-$pkgver"

	./configure  \
		--with-web-user=http \
		--with-web-group=http \
		--with-web-apache-path=/etc/httpd/conf/extra \
		--with-db-socket=/run/mysqld/mysqld.sock \
		--with-conf-dir=/etc/icinga-web \
		--with-log-dir=/var/log/icinga \
		--with-cache-dir=/var/cache/icinga-web \
		--with-icinga-bin=/usr/bin \
		--with-icinga-cfg=/etc/icinga \
		--with-icinga-objects-dir=/etc/icinga/objects \
		--with-api-cmd-file=/var/icinga/rw/icinga.cmd \
		--with-enable-sla
}

package() {
	cd "$srcdir/$pkgname-$pkgver"

  make DESTDIR="$pkgdir" install

	cp etc/apache2/icinga-web.conf $pkgdir/etc/icinga-web/apache.conf.example
}

md5sums=('ea83917b7f9335430de855f68f4318d7')
