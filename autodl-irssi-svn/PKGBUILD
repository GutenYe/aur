# Contributor: Guten <ywzhaifei@gmail.com>

pkgname=autodl-irssi-svn # NAME-git
pkgver=701 # after run once, svn auto add it.
pkgrel=1
pkgdesc="Plugin for irssi which monitor IRC announce channels and download torrents based on user defined filters. see https://wiki.archlinux.org/index.php/Autodl-irssi for Installation."
arch=("i686" "x86_64")
url="http://sourceforge.net/projects/autodl-irssi/"
license=("unknown")
groups=()
depends=("irssi" "perl-archive-zip" "perl-net-ssleay" "perl-html-parser" "perl-xml-libxml" "perl-digest-sha1" "perl-json" "perl-json-xs" "perl-xml-libxslt")
makedepends=()
optdepends=("rutorrent-plugin-autodl-irssi-svn: autodl-irssi plugin for rutorrent.")
provides=()
conflicts=()
replaces=()
backup=()
options=()
install=
changelog=
source=()
md5sums=()

_svntrunk="https://autodl-irssi.svn.sourceforge.net/svnroot/autodl-irssi/trunk/src"
_svnmod="autodl-irssi"

build() {
  cd $startdir/src

  msg "Connecting to SVN server...."
  if [ -d $_svnmod/.svn ]; then
    (cd $_svnmod && svn up -r $pkgver)
  else
    svn co $_svntrunk --config-dir ./ -r $pkgver $_svnmod
  fi
  msg "SVN checkout done or server timeout"
}

package() {
	p_root="$pkgdir/usr/share/autodl-irssi"
  cd $srcdir/$_svnmod

	mkdir -p $p_root
	cp -r * $p_root

	cd $p_root
	rm README.txt
}
