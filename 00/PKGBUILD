# Maintainer: Guten Ye

# cvs
pkgname="hello-git"
source=('[folder::][vcs+]url[#fragment]')



pkgname="hello"
pkgver=1.0.0
pkgrel=1
pkgdesc="description"
arch=("i686" "x86_64" "any")
url="homepage"
license=("Unkown")
depends=("iproute2")
makedepends=("git" "go")
source=(
  "$pkgname-$pkgver.tar.gz::https://github.com/GutenYe/freedom-routes/archive/v$pkgver.tar.gz"
)
backup=("etc/freedom-routes")

build() {
  cd "$srcdir/$pkgname-$pkgver"

  # prepare build environment
  export GOPATH="$srcdir/go"
  mkdir -p "$srcdir/go/src/github.com/GutenYe"
  ln -sfT "$srcdir/$pkgname-$pkgver" "$srcdir/go/src/github.com/GutenYe/freedom-routes"

  # prepare dependency
  go get -v
  platform=$([ $CARCH == "i686" ] && echo "linux_386" || echo "linux_amd64")
  rm -r "$srcdir/go/pkg/$platform/github.com/GutenYe/freedom-routes"

  # begin build
  ./build.sh -d /usr/share/freedom-routes
}

package() {
  cd "$srcdir/$pkgname-$pkgver/dist"

  mkdir -p "$pkgdir/usr/bin"
  mkdir -p "$pkgdir/etc"
  mkdir -p "$pkgdir/usr/share/freedom-routes"
  cp freedom-routes "$pkgdir/usr/bin"
  cp freedom-routes.etc "$pkgdir/etc/freedom-routes"
  cp -r templates "$pkgdir/usr/share/freedom-routes"
}

# vim:set ts=2 sw=2 et:
md5sums=('090415b9ac9ba8426f903dd6dfef2dee')
